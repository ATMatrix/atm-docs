<h1 id='chinb-js'>chinb.js 参考</h1><h2 id='087db63ab1'>安装</h2>
<p>该 Node.js 模块在 npm 上注册.</p>

<p>在安装之前，请确保下载并安装 Node.js。</p>

<p>安装使用以下 npm install 命令完成：</p>

<p><code>$ npm install chinb</code></p>
<h2 id='45fa4e00db'>介绍</h2>
<p>chinb.js 是一个库的集合，它使用 HTTP 或者 IPC 连接与Chinb节点交互，</p>

<p>使用示例:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">Chinb</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'chinb'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">institue_private_key</span><span class="p">:</span> <span class="s2">"XXXXXX"</span><span class="p">,</span>
  <span class="na">validator_private_key</span><span class="p">:</span> <span class="s2">"XXXXX"</span>
<span class="p">}</span>
<span class="kr">const</span> <span class="nx">chinb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Chinb</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
<span class="nx">chinb</span><span class="p">.</span><span class="nx">accounts</span><span class="p">.</span><span class="nx">create</span><span class="p">()</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">){</span>
    <span class="p">...</span>
<span class="p">})</span>
<span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
    <span class="p">...</span>
<span class="p">});</span>
</code></pre>
<aside class="success">
Node.js的版本确保在8.x以上
</aside>
<h2 id='chinb'>chinb</h2>
<p>chinb.js 对象是一个容纳所有 Chinb 相关模块的伞包。</p>
<pre class="highlight plaintext"><code>const Chinb = require('chinb');
const chinb = new Chinb(options);

&gt; chinb.accounts
&gt; chinb.institue
&gt; chinb.validator
&gt; chinb.utils
&gt; chinb.version
</code></pre><h2 id='chinb-accounts'>chinb.accounts</h2>
<p><code>chinb.accounts</code> 包含生成 Chinb 帐号和授权数据的功能。</p>
<h2 id='chinb-accounts-create'>chinb.accounts.create</h2>
<p><code>chinb.accounts.create(id, password)</code></p>

<p>生成带有私钥和公钥的账户对象。</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">chinb</span><span class="p">.</span><span class="nx">accounts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s2">"111111111111111"</span><span class="p">,</span> <span class="s1">'test'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
<span class="p">})</span>
<span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>返回的JSON数据结构如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"987654321000000000"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xb8CE9ab6943e0eCED004cDe8e3bBed6568B2Fa01"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"keystore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{
        version: 3,
        id: '04e9bcbb-96fa-497b-94d1-14df4cd20af6',
        address: '2c7536e3605d9c16a7a3d7b1898e529396a65c23',
        crypto: {
            ciphertext: 'a1c25da3ecde4e6a24f3697251dd15d6208520efc84ad97397e906e6df24d251',
            cipherparams: { iv: '2885df2b63f7ef247d753c82fa20038a' },
            cipher: 'aes-128-ctr',
            kdf: 'scrypt',
            kdfparams: {
                dklen: 32,
                salt: '4531b3c174cc3ff32a6a7a85d6761b410db674807b2d216d022318ceee50be10',
                n: 262144,
                r: 8,
                p: 1
            },
            mac: 'b8b010fff37f9ae5559a352a185e86f9b9c1d7f7a9f1bd4e82a5dd35468fc7f6'
        }
    }"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<aside class="warning">
请确保私钥仅保存在客户端！
</aside>
<h3 id='3fe069830a'>参数表</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>null</td>
<td>用户ID信息</td>
</tr>
<tr>
<td>password</td>
<td>null</td>
<td>在客户端保存私钥之前，用作加密生成的私钥的密码</td>
</tr>
</tbody></table>
<h2 id='chinb-accounts-getbalance'>chinb.accounts.getBalance</h2>
<p><code>chinb.accounts.getBalance(address [, 默认值Block])</code></p>

<p>在指定块上查询给定账户地址的余额。</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">chinb</span><span class="p">.</span><span class="nx">accounts</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="s2">"0x407d73d8a49eeb85d32cf465507dd71d507100c1"</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>返回 <code>balance</code> 如下</p>
</blockquote>
<pre class="highlight plaintext"><code>"1000000000000"
</code></pre><h3 id='3fe069830a-2'>参数表</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>address</td>
<td>null</td>
<td>用户地址信息</td>
</tr>
<tr>
<td>默认值Block</td>
<td>&quot;latest&quot;</td>
<td>如果设置该参数会覆盖掉默认指定块</td>
</tr>
</tbody></table>
<h2 id='chinb-accounts-transfer'>chinb.accounts.transfer</h2>
<p><code>chinb.accounts.transfer(from, to, tokens)</code></p>

<p>从 <code>from</code> 账户地址发送 <code>tokens</code> 数量的代币到 <code>to</code> 账户地址。</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">chinb</span><span class="p">.</span><span class="nx">accounts</span><span class="p">.</span><span class="nx">transfer</span><span class="p">(</span><span class="s2">"0x1111111111111111111111111111111111111111"</span><span class="p">,</span> <span class="s2">"0x2222222222222222222222222222222222222222"</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>返回 <code>receipt</code> 如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x9fc76417374aa880d4449a1f7f31ec597f00b1f6f3dd2d66f4c9c6c445836d8b"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionIndex"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xef95f2f1ed3ca60b048b4bf67cde2195961e0bba6f70bcbea9a2c4e133e34b46"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="s2">"contractAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x11f4d0A3c12e86B4b5F39B213F7E19D048276DAe"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cumulativeGasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">314159</span><span class="p">,</span><span class="w">
  </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">30234</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
         </span><span class="err">//</span><span class="w"> </span><span class="err">logs</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="err">returned</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">getPastLogs</span><span class="p">,</span><span class="w"> </span><span class="err">etc.</span><span class="w">
     </span><span class="p">},</span><span class="w"> </span><span class="err">...</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='3fe069830a-3'>参数表</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>from</td>
<td>null</td>
<td>from address</td>
</tr>
<tr>
<td>to</td>
<td>null</td>
<td>to address</td>
</tr>
<tr>
<td>tokens</td>
<td>null</td>
<td>amount of tokens</td>
</tr>
</tbody></table>
<h2 id='chinb-accounts-authorize'>chinb.accounts.authorize</h2>
<p><code>chinb.accounts.authorize(address, password, msg)</code></p>

<p>授权给定的数据信息。</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">chinb</span><span class="p">.</span><span class="nx">accounts</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s2">"0x407d73d8a49eeb85d32cf465507dd71d507100c1"</span><span class="p">,</span> <span class="s2">"test"</span><span class="p">,</span> <span class="s2">"Some data"</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>返回 <code>sign</code> 如下:</p>
</blockquote>
<pre class="highlight plaintext"><code>{
    message: 'Some data',
    messageHash: '0x1da44b586eb0729ff70a73c326926f6ed5a25f5b056e7f47fbc6e58d86871655',
    v: '0x1c',
    r: '0xb91467e570a6466aa9e9876cbcd013baba02900b8979d43fe208a4a4f339f5fd',
    s: '0x6007e74cd82e037b800186422fc2da167c747ef045e5d18a5f5d4300f8e1a029',
    signature: '0xb91467e570a6466aa9e9876cbcd013baba02900b8979d43fe208a4a4f339f5fd6007e74cd82e037b800186422fc2da167c747ef045e5d18a5f5d4300f8e1a0291c'
}
</code></pre><h3 id='3fe069830a-4'>参数表</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>from</td>
<td>null</td>
<td>授权的账户地址</td>
</tr>
<tr>
<td>password</td>
<td>null</td>
<td>账户的密码</td>
</tr>
<tr>
<td>msg</td>
<td>null</td>
<td>指定授权的信息</td>
</tr>
</tbody></table>
<h2 id='chinb-institue'>chinb.institue</h2>
<p><code>chinb.institue</code> 包含了验证授权信息和恢复用户账户的功能。</p>
<h2 id='chinb-institue-validate'>chinb.institue.validate</h2>
<p><code>chinb.institue.validate(address, sign, msg)</code></p>

<p>验证授权的信息</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">chinb</span><span class="p">.</span><span class="nx">institue</span><span class="p">.</span><span class="nx">validate</span><span class="p">(</span><span class="s2">"0x407d73d8a49eeb85d32cf465507dd71d507100c1"</span><span class="p">,</span> <span class="s2">"0xb91467e570a6466aa9e9876cbcd013baba02900b8979d43fe208a4a4f339f5fd6007e74cd82e037b800186422fc2da167c747ef045e5d18a5f5d4300f8e1a0291c"</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>返回 <code>result</code> 如下:</p>
</blockquote>
<pre class="highlight plaintext"><code>true
</code></pre><h3 id='3fe069830a-5'>参数表</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>address</td>
<td>null</td>
<td>授权的账户地址</td>
</tr>
<tr>
<td>sign</td>
<td>null</td>
<td>授权的签名</td>
</tr>
<tr>
<td>msg</td>
<td>null</td>
<td>授权的信息</td>
</tr>
</tbody></table>
<h2 id='chinb-institue-recover'>chinb.institue.recover</h2>
<p><code>chinb.institue.recover(address)</code></p>

<p>恢复账户</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">chinb</span><span class="p">.</span><span class="nx">institue</span><span class="p">.</span><span class="nx">recover</span><span class="p">(</span><span class="s2">"0x407d73d8a49eeb85d32cf465507dd71d507100c1"</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>返回 <code>result</code> 如下:</p>
</blockquote>
<pre class="highlight plaintext"><code>true
</code></pre><h3 id='3fe069830a-6'>参数表</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>address</td>
<td>null</td>
<td>恢复账户的地址</td>
</tr>
</tbody></table>
