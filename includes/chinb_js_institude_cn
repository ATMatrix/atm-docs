<h1 id='api'>机构侧 API</h1><h2 id='info'>info</h2>
<p>获取机构信息。</p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://localhost:3000/api/info"</span>
</code></pre>
<blockquote>
<p>返回的JSON数据结构如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CHINB1"</span><span class="p">,</span><span class="w">     </span><span class="err">//机构编号</span><span class="w">
    </span><span class="s2">"addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xb8CE9ab6943e0eCED004cDe8e3bBed6568B2Fa01"</span><span class="w">     </span><span class="err">//机构帐号地址</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='http'>HTTP 请求</h3>
<p><code>GET http://localhost:3000/api/info</code></p>
<h2 id='tokens'>tokens</h2>
<p>查询账户余额</p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://localhost:3000/api/tokens/0xb8CE9ab6943e0eCED004cDe8e3bBed6568B2Fa02"</span>
</code></pre>
<blockquote>
<p>返回的JSON数据结构如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"tokens"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10000000000000000000"</span><span class="w">  </span><span class="err">//机构账户余额</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='http-2'>HTTP 请求</h3>
<p><code>GET http://localhost:3000/api/tokens/&lt;addr&gt;</code></p>
<h3 id='url'>URL 参数表</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>addr</td>
<td>null</td>
<td>需要查询的帐号地址</td>
</tr>
</tbody></table>
<h2 id='transfer'>transfer</h2>
<p>机构账户转账</p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://localhost:3000/api/transfer"</span>
  -X POST
  -H <span class="s2">"Content-type: application/json"</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">to</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0xb8CE9ab6943e0eCED004cDe8e3bBed6568B2Fa02</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">amount</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">50</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>
<blockquote>
<p>返回的<code>receipt</code>数据结构如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x9fc76417374aa880d4449a1f7f31ec597f00b1f6f3dd2d66f4c9c6c445836d8b"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionIndex"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xef95f2f1ed3ca60b048b4bf67cde2195961e0bba6f70bcbea9a2c4e133e34b46"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="s2">"contractAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x11f4d0A3c12e86B4b5F39B213F7E19D048276DAe"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cumulativeGasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">314159</span><span class="p">,</span><span class="w">
  </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">30234</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
         </span><span class="err">//</span><span class="w"> </span><span class="err">logs</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="err">returned</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">getPastLogs</span><span class="p">,</span><span class="w"> </span><span class="err">etc.</span><span class="w">
     </span><span class="p">},</span><span class="w"> </span><span class="err">...</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='http-3'>HTTP 请求</h3>
<p><code>POST http://localhost:3000/api/transfer {to: 0x01, amount: 50}</code></p>
<h3 id='715c1ab71d'>请求体参数</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>to</td>
<td>null</td>
<td>token接收者帐号地址</td>
</tr>
<tr>
<td>amount</td>
<td>null</td>
<td>需要转账token的数量</td>
</tr>
</tbody></table>
<h2 id='user_register'>user_register</h2>
<p>为KYC之后的用户在链上注册</p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://localhost:3000/api/user"</span>
  -X POST
  -H <span class="s2">"Content-type: application/json"</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">addr</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0xb8CE9ab6943e0eCED004cDe8e3bBed6568B2Fa03</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">id</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0000000000000000000001</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>
<blockquote>
<p>返回的<code>receipt</code>数据结构如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x9fc76417374aa880d4449a1f7f31ec597f00b1f6f3dd2d66f4c9c6c445836d8b"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionIndex"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xef95f2f1ed3ca60b048b4bf67cde2195961e0bba6f70bcbea9a2c4e133e34b46"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="s2">"contractAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x11f4d0A3c12e86B4b5F39B213F7E19D048276DAe"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cumulativeGasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">314159</span><span class="p">,</span><span class="w">
  </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">30234</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
         </span><span class="err">//</span><span class="w"> </span><span class="err">logs</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="err">returned</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">getPastLogs</span><span class="p">,</span><span class="w"> </span><span class="err">etc.</span><span class="w">
     </span><span class="p">},</span><span class="w"> </span><span class="err">...</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='http-4'>HTTP 请求</h3>
<p><code>POST http://localhost:3000/api/user {addr: 0x02, id: 02}</code></p>
<h3 id='715c1ab71d-2'>请求体参数</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>addr</td>
<td>null</td>
<td>需要注册的用户帐号地址</td>
</tr>
<tr>
<td>id</td>
<td>null</td>
<td>经过KYC的用户身份信息</td>
</tr>
</tbody></table>
<h2 id='user_delete'>user_delete</h2>
<p>在链上删除已经注册的用户信息</p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://localhost:3000/api/user"</span>
  -X DELETE
  -H <span class="s2">"Content-type: application/json"</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">addr</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0xb8CE9ab6943e0eCED004cDe8e3bBed6568B2Fa03</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>
<blockquote>
<p>返回的<code>receipt</code>数据结构如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x9fc76417374aa880d4449a1f7f31ec597f00b1f6f3dd2d66f4c9c6c445836d8b"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionIndex"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xef95f2f1ed3ca60b048b4bf67cde2195961e0bba6f70bcbea9a2c4e133e34b46"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="s2">"contractAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x11f4d0A3c12e86B4b5F39B213F7E19D048276DAe"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cumulativeGasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">314159</span><span class="p">,</span><span class="w">
  </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">30234</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
         </span><span class="err">//</span><span class="w"> </span><span class="err">logs</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="err">returned</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">getPastLogs</span><span class="p">,</span><span class="w"> </span><span class="err">etc.</span><span class="w">
     </span><span class="p">},</span><span class="w"> </span><span class="err">...</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='http-5'>HTTP 请求</h3>
<p><code>DELETE http://localhost:3000/api/user {addr: 0x02}</code></p>
<h3 id='715c1ab71d-3'>请求体参数</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>addr</td>
<td>null</td>
<td>需要删除的用户帐号地址</td>
</tr>
</tbody></table>
<h2 id='recover'>recover</h2>
<p>为经过KYC的用户恢复账户</p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://localhost:3000/api/recover"</span>
  -X POST
  -H <span class="s2">"Content-type: application/json"</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">addr_old</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0xb8CE9ab6943e0eCED004cDe8e3bBed6568B2Fa03</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">addr_new</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0xb8CE9ab6943e0eCED004cDe8e3bBed6568B2Fa04</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>
<blockquote>
<p>返回的<code>receipt</code>数据结构如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x9fc76417374aa880d4449a1f7f31ec597f00b1f6f3dd2d66f4c9c6c445836d8b"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionIndex"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xef95f2f1ed3ca60b048b4bf67cde2195961e0bba6f70bcbea9a2c4e133e34b46"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="s2">"contractAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x11f4d0A3c12e86B4b5F39B213F7E19D048276DAe"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cumulativeGasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">314159</span><span class="p">,</span><span class="w">
  </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">30234</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
         </span><span class="err">//</span><span class="w"> </span><span class="err">logs</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="err">returned</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">getPastLogs</span><span class="p">,</span><span class="w"> </span><span class="err">etc.</span><span class="w">
     </span><span class="p">},</span><span class="w"> </span><span class="err">...</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='http-6'>HTTP 请求</h3>
<p><code>POST http://localhost:3000/api/recover {addr_old: 0x02, addr_new: 0x03}</code></p>
<h3 id='715c1ab71d-4'>请求体参数</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>addr_old</td>
<td>null</td>
<td>用户恢复前的账户地址</td>
</tr>
<tr>
<td>addr_new</td>
<td>null</td>
<td>用户恢复后的账户地址</td>
</tr>
</tbody></table>
<h2 id='verify'>verify</h2>
<p>用户授权的信息在链上校验并永久保存</p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://localhost:3000/api/verify"</span>
  -X POST
  -H <span class="s2">"Content-type: application/json"</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">addr</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">0x2222222222222222222222222222222222222222</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">id</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">11111</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">message</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">Some data</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">messageHash</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0x1da44b586eb0729ff70a73c326926f6ed5a25f5b056e7f47fbc6e58d86871655</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">v</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0x1c</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">r</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0xb91467e570a6466aa9e9876cbcd013baba02900b8979d43fe208a4a4f339f5fd</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">s</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">0x6007e74cd82e037b800186422fc2da167c747ef045e5d18a5f5d4300f8e1a029</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">signature</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">Some 0xb91467e570a6466aa9e9876cbcd013baba02900b8979d43fe208a4a4f339f5fd6007e74cd82e037b800186422fc2da167c747ef045e5d18a5f5d4300f8e1a0291c</span><span class="se">\"</span><span class="s2">}"</span>
</code></pre>
<blockquote>
<p>返回的<code>receipt</code>数据结构如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x9fc76417374aa880d4449a1f7f31ec597f00b1f6f3dd2d66f4c9c6c445836d8b"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactionIndex"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockHash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xef95f2f1ed3ca60b048b4bf67cde2195961e0bba6f70bcbea9a2c4e133e34b46"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"blockNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="s2">"contractAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x11f4d0A3c12e86B4b5F39B213F7E19D048276DAe"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cumulativeGasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">314159</span><span class="p">,</span><span class="w">
  </span><span class="s2">"gasUsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">30234</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logs"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
         </span><span class="err">//</span><span class="w"> </span><span class="err">logs</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="err">returned</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">getPastLogs</span><span class="p">,</span><span class="w"> </span><span class="err">etc.</span><span class="w">
     </span><span class="p">},</span><span class="w"> </span><span class="err">...</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='http-7'>HTTP 请求</h3>
<p><code>POST http://localhost:3000/api/verify {signObject}</code></p>
<h3 id='715c1ab71d-5'>请求体参数</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>signObject</td>
<td>null</td>
<td>用户授权签名的签名对象</td>
</tr>
</tbody></table>
<h2 id='gas'>gas</h2>
<p>查询账户燃料余量</p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://localhost:3000/api/gas/0xb8CE9ab6943e0eCED004cDe8e3bBed6568B2Fa02"</span>
</code></pre>
<blockquote>
<p>返回的JSON数据结构如下:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"ATN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="w">  </span><span class="err">//账户燃料余量</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='http-8'>HTTP 请求</h3>
<p><code>GET http://localhost:3000/api/gas/&lt;addr&gt;</code></p>
<h3 id='url-2'>URL 参数表</h3>
<table><thead>
<tr>
<th>参数</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead><tbody>
<tr>
<td>addr</td>
<td>null</td>
<td>需要查询的帐号地址</td>
</tr>
</tbody></table>
<h2 id='b859c7be75'>错误</h2>
<p>机构侧 API 应用以下错误编码:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable</td>
</tr>
<tr>
<td>410</td>
<td>Gone</td>
</tr>
<tr>
<td>418</td>
<td>I&#39;m a teapot.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable</td>
</tr>
</tbody></table>
